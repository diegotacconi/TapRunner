<Window x:Class="TapRunner.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="TapRunner"
        MinHeight="200" MinWidth="300"
        Height="600" Width="800">
    <Grid Background="WhiteSmoke">

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Start of TestPlanPanel -->
        <Border Grid.Row="0" Margin="6,6,6,0" Background="Transparent">
            <StackPanel Orientation="Horizontal" Background="Transparent">

                <Label Content="Test Plan:" FontSize="14"/>
                <TextBox x:Name="TestPlanTextBox" Margin="3,0,3,0" Height="23" Width="300" VerticalContentAlignment="Center" BorderThickness="1" BorderBrush="Gray"
                         Text="{Binding Path=PlanPath}" />
                <Button x:Name="BrowseButton" Margin="3,0,3,0" Width="23" Height="23" FontSize="18"
                        BorderThickness="0"
                        Content="..." ToolTip="Open test plan file"
                        Click="BrowseButton_OnClick">
                </Button>
                <Button x:Name="RunButton" Margin="3,0,3,0" Width="23" Height="23" FontSize="18" UseLayoutRounding="True"
                        BorderThickness="0"
                        FontFamily="Segoe MDL2 Assets" Content="&#xE768;" ToolTip="Run test plan"
                        Click="RunButton_OnClick">
                </Button>
                <Button x:Name="AbortButton" Margin="3,0,3,0" Width="23" Height="23" FontSize="18" UseLayoutRounding="True"
                        BorderThickness="0"
                        FontFamily="Segoe MDL2 Assets" Content="&#xE71A;" ToolTip="Abort test plan execution"
                        Click="AbortButton_OnClick">
                </Button>

            </StackPanel>
        </Border>
        <!-- End of TestPlanPanel -->

        <!-- Start of ResultsPanel -->
        <Border Grid.Row="1" Margin="6,6,6,0">
            <TabControl>
                <!--
                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="Plan" FontSize="14" />
                    </TabItem.Header>
                    <Grid Background="#FFE5E5E5"/>
                </TabItem>
                -->
                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="Results" FontSize="14"/>
                    </TabItem.Header>
                    <Grid>
                        <ListView x:Name="ResultsListView" FontFamily="Consolas" FontWeight="Normal" BorderThickness="0">

                            <ListView.Resources>
                                <Style TargetType="{x:Type GridViewColumnHeader}">
                                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                    <Setter Property="Padding" Value="6,3,6,3"/>
                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                </Style>
                            </ListView.Resources>

                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Name" Width="270" DisplayMemberBinding="{Binding Name}"/>
                                    <GridViewColumn Header="Verdict" Width="70" DisplayMemberBinding="{Binding Verdict}"/>
                                    <GridViewColumn Header="Value" Width="90" DisplayMemberBinding="{Binding Value}"/>
                                    <GridViewColumn Header="Unit" Width="90" DisplayMemberBinding="{Binding Unit}"/>
                                    <GridViewColumn Header="Low Limit" Width="90" DisplayMemberBinding="{Binding LowLimit}"/>
                                    <GridViewColumn Header="High Limit" Width="90" DisplayMemberBinding="{Binding HighLimit}"/>
                                    <GridViewColumn Header="Comment" Width="75" DisplayMemberBinding="{Binding Comment}"/>
                                </GridView>
                            </ListView.View>

                            <ListView.ContextMenu>
                                <ContextMenu x:Name = "ResultsListViewCommandMenu">
                                    <MenuItem Header="Clear Results Panel"/>
                                    <MenuItem Header="Copy"/>
                                </ContextMenu>
                            </ListView.ContextMenu>

                        </ListView>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
        <!-- End of ResultsPanel -->

        <GridSplitter Grid.Row="2" Height="6" Background="Transparent" HorizontalAlignment="Stretch"/>

        <!-- Start of LogPanel -->
        <Border Grid.Row="3" Margin="6,0,6,6">
            <TabControl>
                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="Log" FontSize="14"/>
                    </TabItem.Header>
                    <Grid>
                        <ListView x:Name="LogListView" FontFamily="Consolas" FontWeight="Normal" BorderThickness="0" SelectionMode="Extended">

                            <!-- This is required to handle ALT+C and CTRL+C -->
                            <ListView.CommandBindings>
                                <CommandBinding Command="Copy" Executed="CopyLogPanel" />
                                <CommandBinding Command="Cut" Executed="ClearLogPanel" />
                            </ListView.CommandBindings>

                            <!-- This is required to handle ALT+C and CTRL+C -->
                            <ListView.InputBindings>
                                <KeyBinding Key="C" Modifiers="Control" Command="Copy" />
                                <KeyBinding Key="C" Modifiers="Alt" Command="Cut" />
                            </ListView.InputBindings>

                            <ListView.Resources>
                                <Style TargetType="{x:Type GridViewColumnHeader}">
                                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                    <Setter Property="Padding" Value="6,3,6,3"/>
                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                </Style>
                            </ListView.Resources>

                            <ListView.View>
                                <!-- <GridView ColumnHeaderContainerStyle="{StaticResource StyleGridViewColumnHeader}"> -->
                                <GridView>
                                    <GridViewColumn Header="Timestamp" Width="100"  DisplayMemberBinding="{Binding Timestamp}"/>
                                    <GridViewColumn Header="Source" Width="120" DisplayMemberBinding="{Binding Source}"/>
                                    <GridViewColumn Header="Message"  Width="1000" DisplayMemberBinding="{Binding Message}"/>
                                </GridView>
                            </ListView.View>

                            <ListView.ContextMenu>
                                <ContextMenu x:Name = "LogListViewCommandMenu">
                                    <MenuItem Header="Clear Log Panel" InputGestureText="Alt+C"  Click="ClearLogPanel"/>
                                    <MenuItem Header="Copy" InputGestureText="Ctrl+C" Click="CopyLogPanel"/>
                                </ContextMenu>
                            </ListView.ContextMenu>

                        </ListView>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
        <!-- End of LogPanel -->

    </Grid>
</Window>
